---
description: üõ°Ô∏è PROJECT GUARDIAN - MANDATORY RULES FOR AI AGENT
globs: **/*
alwaysApply: true
---

# üõ°Ô∏è GUARDIAN PROTOCOL - ACTIVE

> ‚ö†Ô∏è **MANDATORY**: This file controls ALL your actions in this project.
> You MUST read relevant sections before EVERY response.
> Violations will cause bugs and user frustration.

---

# üî¥ SECTION 0: ENFORCEMENT RULES

## On EVERY user request, you MUST:

```
1. IDENTIFY what sections apply to this request
2. RE-READ those sections before responding  
3. CHECK file tree before creating/modifying files
4. VERIFY your changes don't violate any rules
5. UPDATE this file if you made structural changes
```

## Auto-Update Triggers:

| When this happens... | Update this section... |
|---------------------|------------------------|
| Created new file | ‚Üí File Tree + Recent Changes |
| Deleted file | ‚Üí File Tree + Recent Changes |
| Fixed a bug | ‚Üí Current Issues + Recent Changes |
| Made important decision | ‚Üí Decision Log |
| Changed project structure | ‚Üí File Tree |

---

# üîí SECTION 1: LOCKED TECHNOLOGIES

## DO NOT SUGGEST ALTERNATIVES TO THESE:

```yaml
Frontend:
  Framework: React 18
  UI_Library: Shadcn/ui
  Styling: Tailwind CSS

Backend:
  Framework: FastAPI
  Database: SQLite
  Auth: JWT

Tools:
  Package_Manager: npm
  Language: TypeScript (frontend), Python 3.11 (backend)
```

### ‚ùå FORBIDDEN (Never suggest these):
```
- Vue, Angular, Svelte (use React)
- Django, Flask, Express (use FastAPI)
- MongoDB, PostgreSQL for MVP (use SQLite)
- Redux (use Zustand or React Context)
- CSS Modules (use Tailwind)
```

### ‚úÖ APPROVED (Safe to use):
```
- Any Shadcn/ui component
- Tailwind utilities
- Lucide icons
- Axios or fetch for API
- React Router
- Zustand for state
```

---

# üìÅ SECTION 2: DYNAMIC FILE TREE

> **CRITICAL**: Check this BEFORE creating ANY file!
> If file exists ‚Üí modify it
> If similar file exists ‚Üí ASK before creating new one

## Current Structure:

```
my-app/
‚îÇ
‚îú‚îÄ‚îÄ üìÇ src/                      # Frontend source code
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ components/           # Reusable UI components
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ui/                  # Shadcn components
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ button.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ input.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ card.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Header.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Sidebar.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ChatMessage.tsx
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ pages/                # Page components
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Home.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Dashboard.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Settings.tsx
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ hooks/                # Custom React hooks
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useAuth.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ useApi.ts
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ lib/                  # Utilities & helpers
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api.ts               # API client
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ utils.ts             # General utilities
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ cn.ts                # Tailwind merge utility
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ App.tsx                  # Main app component
‚îÇ   ‚îú‚îÄ‚îÄ main.tsx                 # Entry point
‚îÇ   ‚îî‚îÄ‚îÄ index.css                # Global styles + Tailwind
‚îÇ
‚îú‚îÄ‚îÄ üìÇ api/                      # Backend source code
‚îÇ   ‚îú‚îÄ‚îÄ main.py                  # FastAPI entry point
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ routes/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ chat.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ users.py
‚îÇ   ‚îú‚îÄ‚îÄ üìÇ models/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ schemas.py
‚îÇ   ‚îî‚îÄ‚îÄ üìÇ services/
‚îÇ       ‚îî‚îÄ‚îÄ ai_service.py
‚îÇ
‚îú‚îÄ‚îÄ üìÇ public/                   # Static assets
‚îÇ   ‚îî‚îÄ‚îÄ favicon.ico
‚îÇ
‚îî‚îÄ‚îÄ üìÑ Configuration
    ‚îú‚îÄ‚îÄ package.json
    ‚îú‚îÄ‚îÄ tsconfig.json
    ‚îú‚îÄ‚îÄ tailwind.config.js
    ‚îú‚îÄ‚îÄ vite.config.ts
    ‚îî‚îÄ‚îÄ requirements.txt
```

## File Placement Rules:

| File Type | Goes In | Example |
|-----------|---------|---------|
| React Components | `src/components/` | `Button.tsx` |
| Shadcn UI | `src/components/ui/` | `card.tsx` |
| Pages | `src/pages/` | `Dashboard.tsx` |
| Custom Hooks | `src/hooks/` | `useAuth.ts` |
| Utilities | `src/lib/` | `utils.ts` |
| API Routes | `api/routes/` | `users.py` |
| Pydantic Models | `api/models/` | `schemas.py` |
| Backend Services | `api/services/` | `ai_service.py` |

## ‚ùå NEVER:
- Create files in project root (except configs)
- Create new folders without user approval
- Create duplicate functionality
- Leave orphan files

## ‚úÖ BEFORE Creating ANY File:

```
‚ñ° Checked file tree - doesn't exist?
‚ñ° Checked similar files - no duplicates?
‚ñ° Correct location per table above?
‚ñ° Will update file tree after creation?
```

---

# üìä SECTION 3: PROJECT STATUS

## Last Synced: 2024-12-03T12:30:00Z

### Current Issues:
```
1. WebSocket disconnects after 5 minutes idle
2. Dark mode toggle not persisting
```
> When you fix an issue, REMOVE it from here and add to Recent Changes

### Recent Changes:
| Date | Change | Files Affected |
|------|--------|----------------|
| 2024-12-03 | Added chat history feature | `src/pages/Dashboard.tsx`, `api/routes/chat.py` |
| 2024-12-02 | Fixed auth token refresh | `src/hooks/useAuth.ts` |
| 2024-12-01 | Initial project setup | Multiple files |

---

# üîß SECTION 4: DEBUG INTEGRATION

## Report Location: `~/Desktop/guardian-reports/`

### BEFORE fixing any bug:
```bash
# Read this file FIRST:
cat ~/Desktop/guardian-reports/AGENT_SUMMARY.md
```

### If reports exist, they contain:
- Actual errors (not guesses)
- Failed network requests
- System state at time of failure

### If reports don't exist:
- Ask user to run diagnostics first
- Don't guess the problem

---

# üìù SECTION 5: DECISION LOG

> Decisions marked üîí are PERMANENT. Never suggest changing them.

| Date | Decision | Reason | Status |
|------|----------|--------|--------|
| 2024-12-01 | Use React 18 | Team expertise | üîí Locked |
| 2024-12-01 | Use FastAPI | Async + auto docs | üîí Locked |
| 2024-12-01 | Use SQLite for MVP | Simplicity, migrate later | üîí Locked |
| 2024-12-01 | Use Tailwind | Rapid prototyping | üîí Locked |
| 2024-12-02 | Use Shadcn/ui | Accessible + customizable | üîí Locked |
| 2024-12-02 | JWT for auth | Stateless, scalable | üîí Locked |

---

# üöÄ SECTION 6: COMMANDS

## How to Run (Development):
```bash
# Terminal 1 - Backend:
cd api
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt
uvicorn main:app --reload --port 8000

# Terminal 2 - Frontend:
npm install
npm run dev
```

## How to Build:
```bash
npm run build
```

## How to Test:
```bash
# Frontend
npm test

# Backend  
pytest
```

## Important URLs:
- Frontend: http://localhost:5173
- Backend: http://localhost:8000
- API Docs: http://localhost:8000/docs

---

# ‚úÖ SECTION 7: RESPONSE CHECKLIST

## Before EVERY response, verify:

### If creating/modifying files:
```
‚ñ° Checked Section 2 (File Tree)?
‚ñ° File goes in correct location?
‚ñ° Not duplicating existing file?
‚ñ° Will update file tree after?
```

### If suggesting solutions:
```
‚ñ° Using only locked technologies (Section 1)?
‚ñ° Not suggesting forbidden alternatives?
‚ñ° Read debug reports if bug-related?
```

### If saying "Done" or "Fixed":
```
‚ñ° Actually tested/verified?
‚ñ° No console errors?
‚ñ° Updated Current Issues?
‚ñ° Added to Recent Changes?
```

## ‚ö†Ô∏è HONESTY RULE:
If you're not 100% sure something works, say:
> "I made changes to X. Please test by doing Y to confirm it works."

Never say "Done!" without verification.

---

# üîÑ SECTION 8: SELF-UPDATE PROTOCOL

## After ANY structural change, update this file:

### New file created:
```markdown
1. Add to File Tree (Section 2)
2. Add to Recent Changes (Section 3)
```

### File deleted:
```markdown
1. Remove from File Tree (Section 2)  
2. Add to Recent Changes (Section 3)
```

### Bug fixed:
```markdown
1. Remove from Current Issues (Section 3)
2. Add to Recent Changes (Section 3)
```

### New decision made:
```markdown
1. Add to Decision Log (Section 5)
2. If about tech ‚Üí Add to Section 1
```

---

# üì¢ FINAL REMINDER

You are an AI assistant with memory limitations. This file IS your memory for this project.

**Every time you respond:**
1. Relevant sections = Your context
2. File tree = Your map
3. Decision log = Your history
4. This file = Your single source of truth

**The user trusts you to:**
- Follow these rules consistently
- Keep this file updated
- Be honest about what works and what doesn't

---

*üõ°Ô∏è Guardian Protocol Active | Last Updated: 2024-12-03T12:30:00Z*
